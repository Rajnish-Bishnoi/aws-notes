# 📦 Amazon EBS Operations (Complete Notes for GitHub)

## 📘 Overview
Amazon EBS (Elastic Block Store) provides persistent block storage volumes for use with Amazon EC2. You can attach EBS volumes to any running EC2 instance in the same Availability Zone.

---

## 🛠️ EBS Volume Creation Steps

1. **Go to EC2 Console**: Visit the [Amazon EC2 Console](https://console.aws.amazon.com/ec2/).
2. **Navigate to Volumes**: In the sidebar menu, click on **Volumes**.
3. **Create a Volume**: Click **Create Volume**.
4. **Choose Volume Type**:
   - General Purpose (gp3, gp2)
   - Provisioned IOPS (io1, io2)
   - Cold HDD (sc1)
   - Throughput Optimized HDD (st1)
5. **Specify Size**: Choose volume size in GiB.
6. **Set IOPS / Throughput (Optional)**: Depending on volume type.
7. **Select Availability Zone**: Must match the zone of the target EC2 instance.
8. **Enable Encryption (Optional)**: Choose encryption key (default or custom).
9. **Add Tags (Optional)**: Add key-value pairs.
10. **Click Create Volume**

> 💡 **Tip**: Always ensure AZ (Availability Zone) of EBS and EC2 match!

---

## 🔗 Attach EBS Volume to EC2

1. Navigate to **Volumes** in EC2 Console.
2. Select your volume → Click **Actions > Attach Volume**.
3. Choose the target **Instance ID**.
4. Enter **Device Name** (e.g., `/dev/xvdf` for Linux).
5. Click **Attach Volume**.

🔸 Once attached, volume shows up as a block device. Format & mount it to use.

---

## 🐧 Enable EBS Volume in Linux

### Step-by-Step:

1. **Connect to EC2 via SSH**:
```bash
ssh -i key.pem ec2-user@<your-ec2-public-ip>
```

2. **Check Device**:
```bash
lsblk
```

3. **Check File System (Optional)**:
```bash
sudo file -s /dev/xvdf
```

4. **Create File System (if needed)**:
```bash
sudo mkfs -t xfs /dev/xvdf
```
> ⚠️ If command fails, install XFS tools: `sudo yum install xfsprogs`

5. **Create Mount Point & Mount Volume**:
```bash
sudo mkdir /data
sudo mount /dev/xvdf /data
```

✅ Volume is now ready to use under `/data`

---

## 🪟 Enable EBS Volume in Windows (DiskPart Method)

### Step-by-Step:
1. **Login via RDP to Windows EC2**
2. **Find Disk**:
```powershell
Get-Disk
```
3. **Create DiskPart Script (`diskpart.txt`)**:
```text
select disk 1
attributes disk clear readonly
online disk noerr
convert mbr
create partition primary
format quick fs=ntfs label="MyVolume"
assign letter=E
```
4. **Run Script in CMD**:
```cmd
diskpart /s C:\diskpart.txt
```

✅ Volume will now appear in Windows Explorer as Drive E:

---

## 🔄 Unmount & Detach Volume

### On Linux:
```bash
sudo umount -d /dev/sdh
```

### Detach from Console:
1. Go to **Volumes** in EC2 Console
2. Select volume → **Actions > Detach Volume**
3. Confirm Detach

---

## 🔐 Important Detach Considerations

- Data is **not lost** on detaching
- Must **unmount first** (Linux)
- If volume is **root**, stop instance first
- **Can reattach** later, but mount point might differ
- **Billing continues** until volume is deleted

> 💡 To avoid extra charges, delete unused volumes!

---

## ❌ Delete an EBS Volume

1. Go to [EC2 Console](https://console.aws.amazon.com/ec2/)
2. Choose **Volumes > Select Volume**
3. Click **Actions > Delete Volume**
4. Confirm delete

⚠️ If greyed out → Volume is still attached → Detach it first.

> ✅ Tip: Take a **snapshot** before deleting if you may need the data later.

---

## 🧠 Mind Map: EBS Operations Summary

```text
EBS Operations
├── Create Volume
│   ├── Choose Type
│   ├── Set Size
│   ├── Select AZ
│   └── Enable Encryption
├── Attach Volume
│   ├── Select Volume
│   ├── Choose EC2
│   └── Assign Device Name
├── Use in OS
│   ├── Linux: lsblk, mkfs, mount
│   └── Windows: DiskPart
├── Detach Volume
│   ├── Unmount (Linux)
│   ├── Stop Instance (Root Vol)
│   └── Detach from Console
└── Delete Volume
    ├── Take Snapshot (Optional)
    └── Delete from Console
```

---

## 🧠 Quick Memory Tips

- **LSD** = `lsblk` → `sudo file` → `mkfs` → `mkdir` → `mount`
- **WAD** = `Windows` → `Assign` → `Diskpart`
- Detach ≠ Delete → You still pay till you delete!

---

