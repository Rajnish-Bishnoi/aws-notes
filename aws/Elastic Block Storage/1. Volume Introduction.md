# Amazon EBS Volumes (Elastic Block Store)

Amazon EBS (Elastic Block Store) is a durable, block-level storage service provided by AWS. It's used to store data, host applications, and boot EC2 instances. EBS volumes act like external hard drives that are attached to EC2 instances.

---

## ðŸ“Œ Key Concepts

* **Durable & Persistent**: Data stored on EBS persists even after the EC2 instance is stopped or terminated (unless it's a root volume without `Delete on Termination` disabled).
* **Block-level Storage**: Like hard drives, ideal for OS, apps, DBs, and log storage.
* **AZ-Specific**: EBS volumes and EC2 instances must be in the **same Availability Zone (AZ)** to attach.
* **Network Attached**: The volume is not inside the host but connected via AWS network.

---

## ðŸ”§ Common Use Cases

* Hosting applications (e.g., web apps, databases)
* Booting an OS (as root volume)
* Storing logs or backups
* High availability and fault tolerance

---

## ðŸ§  Features

| Feature                     | Description                                                                               |
| --------------------------- | ----------------------------------------------------------------------------------------- |
| **Attach/Detach**           | Volumes can be attached to one instance at a time (some types support multi-attach).      |
| **Resize (Only Increase)**  | Volume size can be increased.                                                             |
| **Encrypted Volumes**       | Encryption at rest using AWS KMS.                                                         |
| **Multi-Attach (Optional)** | For some EBS volume types, a volume can be attached to multiple instances simultaneously. |
| **Persistent Storage**      | Data is preserved across instance stops/restarts.                                         |

---

## ðŸªœ Step-by-Step: Creating & Attaching EBS Volume

### âœ… Step 1: Create a Volume

1. Go to AWS Console â†’ EC2 Dashboard â†’ **Elastic Block Store â†’ Volumes**.
2. Click **Create Volume**.
3. Select:

   * Volume type (e.g., gp3 or gp2 for general purpose)
   * Size (e.g., 8 GiB)
   * Availability Zone (must match EC2 instance AZ)
4. Click **Create Volume**.

### âœ… Step 2: Attach Volume to EC2 Instance

1. After volume is created â†’ **Actions â†’ Attach Volume**.
2. Choose the **EC2 instance ID** from the same AZ.
3. Click **Attach**.

### âœ… Step 3: Format & Mount the Volume (on EC2)

Run the following commands after connecting to your EC2 instance:

```bash
lsblk                         # Check available block devices
sudo mkfs -t ext4 /dev/xvdf  # Format the new volume
sudo mkdir /data             # Create mount point
sudo mount /dev/xvdf /data   # Mount volume
```

To make the mount **permanent**:

```bash
echo '/dev/xvdf /data ext4 defaults,nofail 0 2' | sudo tee -a /etc/fstab
```

---

## ðŸ”„ Step-by-Step: Unmounting and Detaching EBS Volume

### âœ… Step 4: Unmount the Volume (Before Detaching)

```bash
sudo umount /data            # Unmount the volume
```

* If the volume is busy, check which process is using it:

```bash
sudo lsof /data
```

* Or force unmount (only if necessary):

```bash
sudo umount -l /data
```

### âœ… Step 5: Detach Volume from EC2

1. Go to EC2 Dashboard â†’ **Elastic Block Store â†’ Volumes**.
2. Select the volume â†’ **Actions â†’ Detach Volume**.
3. Confirm detachment.

Now the volume is safely detached and can be attached to another instance or deleted.

---

## ðŸ§­ Mind Map: EBS Volume Lifecycle

```plaintext
EBS Volume
â”œâ”€â”€ Create Volume
â”‚   â””â”€â”€ Choose Type, Size, AZ
â”œâ”€â”€ Attach to EC2
â”‚   â””â”€â”€ Match AZ â†’ Attach via Console
â”œâ”€â”€ Format & Mount
â”‚   â”œâ”€â”€ mkfs (format)
â”‚   â””â”€â”€ mount to /data
â”œâ”€â”€ Use Volume
â”‚   â””â”€â”€ Store Logs, Data, etc.
â”œâ”€â”€ Unmount
â”‚   â””â”€â”€ umount /data
â””â”€â”€ Detach
    â””â”€â”€ Via Console â†’ Detach
```

---

## ðŸ›‘ Notes

* EBS volumes are **charged per GB per month**, plus IOPS (for some types).
* Deleting the EC2 instance **does not delete the volume** unless `Delete on Termination` is checked.
* Volumes can be **snapshotted** for backup and **restored** into new volumes.

---

## ðŸ’¡ Example:

You have a web server EC2 instance and you need to store logs separately. You can:

* Create a 20 GB EBS volume
* Attach it to your instance
* Mount it to `/var/logs`
* Now your logs are stored on a separate persistent disk

---

## ðŸ“˜ Summary

| Feature                 | Available?        |
| ----------------------- | ----------------- |
| Persistent after reboot | âœ…                 |
| Resize volume           | âœ… (Only increase) |
| Multi-Attach            | âœ… (Some types)    |
| Encrypted               | âœ…                 |
| AZ Specific             | âœ…                 |

---

ðŸ“ **Next:** Learn about **Snapshots** (backing up your EBS volume)

> âœ… Tip: Use EBS for important data and enable snapshot backups regularly!
