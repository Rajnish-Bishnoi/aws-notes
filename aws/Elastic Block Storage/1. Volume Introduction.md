# Amazon EBS Volumes (Elastic Block Store)

Amazon EBS (Elastic Block Store) is a durable, block-level storage service provided by AWS. It's used to store data, host applications, and boot EC2 instances. EBS volumes act like external hard drives that are attached to EC2 instances.

---

## 📌 Key Concepts

* **Durable & Persistent**: Data stored on EBS persists even after the EC2 instance is stopped or terminated (unless it's a root volume without `Delete on Termination` disabled).
* **Block-level Storage**: Like hard drives, ideal for OS, apps, DBs, and log storage.
* **AZ-Specific**: EBS volumes and EC2 instances must be in the **same Availability Zone (AZ)** to attach.
* **Network Attached**: The volume is not inside the host but connected via AWS network.

---

## 🔧 Common Use Cases

* Hosting applications (e.g., web apps, databases)
* Booting an OS (as root volume)
* Storing logs or backups
* High availability and fault tolerance

---

## 🧠 Features

| Feature                     | Description                                                                               |
| --------------------------- | ----------------------------------------------------------------------------------------- |
| **Attach/Detach**           | Volumes can be attached to one instance at a time (some types support multi-attach).      |
| **Resize (Only Increase)**  | Volume size can be increased.                                                             |
| **Encrypted Volumes**       | Encryption at rest using AWS KMS.                                                         |
| **Multi-Attach (Optional)** | For some EBS volume types, a volume can be attached to multiple instances simultaneously. |
| **Persistent Storage**      | Data is preserved across instance stops/restarts.                                         |

---

## 🪜 Step-by-Step: Creating & Attaching EBS Volume

### ✅ Step 1: Create a Volume

1. Go to AWS Console → EC2 Dashboard → **Elastic Block Store → Volumes**.
2. Click **Create Volume**.
3. Select:

   * Volume type (e.g., gp3 or gp2 for general purpose)
   * Size (e.g., 8 GiB)
   * Availability Zone (must match EC2 instance AZ)
4. Click **Create Volume**.

### ✅ Step 2: Attach Volume to EC2 Instance

1. After volume is created → **Actions → Attach Volume**.
2. Choose the **EC2 instance ID** from the same AZ.
3. Click **Attach**.

### ✅ Step 3: Format & Mount the Volume (on EC2)

Run the following commands after connecting to your EC2 instance:

```bash
lsblk                         # Check available block devices
sudo mkfs -t ext4 /dev/xvdf  # Format the new volume
sudo mkdir /data             # Create mount point
sudo mount /dev/xvdf /data   # Mount volume
```

To make the mount **permanent**:

```bash
echo '/dev/xvdf /data ext4 defaults,nofail 0 2' | sudo tee -a /etc/fstab
```

---

## 🔄 Step-by-Step: Unmounting and Detaching EBS Volume

### ✅ Step 4: Unmount the Volume (Before Detaching)

```bash
sudo umount /data            # Unmount the volume
```

* If the volume is busy, check which process is using it:

```bash
sudo lsof /data
```

* Or force unmount (only if necessary):

```bash
sudo umount -l /data
```

### ✅ Step 5: Detach Volume from EC2

1. Go to EC2 Dashboard → **Elastic Block Store → Volumes**.
2. Select the volume → **Actions → Detach Volume**.
3. Confirm detachment.

Now the volume is safely detached and can be attached to another instance or deleted.

---

## 🧭 Mind Map: EBS Volume Lifecycle

```plaintext
EBS Volume
├── Create Volume
│   └── Choose Type, Size, AZ
├── Attach to EC2
│   └── Match AZ → Attach via Console
├── Format & Mount
│   ├── mkfs (format)
│   └── mount to /data
├── Use Volume
│   └── Store Logs, Data, etc.
├── Unmount
│   └── umount /data
└── Detach
    └── Via Console → Detach
```

---

## 🛑 Notes

* EBS volumes are **charged per GB per month**, plus IOPS (for some types).
* Deleting the EC2 instance **does not delete the volume** unless `Delete on Termination` is checked.
* Volumes can be **snapshotted** for backup and **restored** into new volumes.

---

## 💡 Example:

You have a web server EC2 instance and you need to store logs separately. You can:

* Create a 20 GB EBS volume
* Attach it to your instance
* Mount it to `/var/logs`
* Now your logs are stored on a separate persistent disk

---

## 📘 Summary

| Feature                 | Available?        |
| ----------------------- | ----------------- |
| Persistent after reboot | ✅                 |
| Resize volume           | ✅ (Only increase) |
| Multi-Attach            | ✅ (Some types)    |
| Encrypted               | ✅                 |
| AZ Specific             | ✅                 |

---

📝 **Next:** Learn about **Snapshots** (backing up your EBS volume)

> ✅ Tip: Use EBS for important data and enable snapshot backups regularly!
